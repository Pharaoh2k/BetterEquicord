name: Sync Fork with Upstream

on:
  schedule:
    - cron: "0 0 * * *"   # daily 00:00 UTC
  workflow_dispatch:

# Do NOT put `workflows:` here; it’s not a valid permission key.
permissions:
  contents: write
  actions: read

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout (no persisted creds)
        uses: actions/checkout@v4
        with:
          persist-credentials: false

      - name: Sync upstream → fork
        uses: aormsby/Fork-Sync-With-Upstream-action@v3.4.1
        with:
          upstream_sync_repo: Equicord/Equicord
          upstream_sync_branch: main
          target_sync_branch: main

          # Use a PAT that has the `workflow` scope (classic),
          # or a fine-grained PAT with Contents: Read & write + Actions: Read & write.
          target_repo_token: ${{ secrets.UPSTREAM_SYNC_PAT }}

          git_config_user: "GH Action - Upstream Sync"
          git_config_email: "action@github.com"
          shallow_since: "1 month ago"
